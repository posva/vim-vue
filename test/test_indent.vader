#
# HTML
#
Given vue (An unindented html template):
  <template>
  <div>
  Hello
  </div>
  </template>

Do (Indent the whole buffer):
  gg=G

Expect (The html template got indented):
  <template>
    <div>
      Hello
    </div>
  </template>


Given vue (Template tag inside a template):
  <template>
    <div>
      <template v-if="loading">
        Loading...
      </template>
    </div>
  </template>

Do (Indent the whole buffer):
  gg=G

Expect (It didn't get unindented):
  <template>
    <div>
      <template v-if="loading">
        Loading...
      </template>
    </div>
  </template>

#
# JavaScript
#
Given vue (An unindented JavaScript region):
  <script>
  export default {
  methods: {
  foo() {
  //
  }
  }
  }
  </script>

Do (Indent the whole buffer):
  gg=G

Expect vue (The JavaScript region got indented):
  <script>
  export default {
    methods: {
      foo() {
        //
      }
    }
  }
  </script>

#
# CSS
#
Given vue (An unindented css region):
  <style>
  body {
  background: tomato;
  }
  </style>

Do (Indent the whole buffer):
  gg=G

Expect vue (The css region got indented):
  <style>
  body {
    background: tomato;
  }
  </style>

#
# Pug
#
Given vue (Empty Pug region):
  <template lang="pug">
  </template>

Do (Insert list items):
  o
  ul\<CR>
  li Item A\<CR>
  li Item B

Expect:
  <template lang="pug">
  ul
    li Item A
    li Item B
  </template>

#
# Stylus
#
Given vue (Empty Stylus region):
  <style lang="stylus">
  </style>

Do (Insert some styles):
  o
  body\<CR>
  font-size: 14px\<CR>
  \<CR>\<C-d>
  h1\<CR>
  font-size: 30px\<CR>
  display: block

Expect:
  <style lang="stylus">
  body
    font-size: 14px

  h1
    font-size: 30px
    display: block
  </style>

#
# Mixed
#
Given vue (Mixed with default settings):
  <template>
  <div>
  <template v-if="loading">
  Loading...
  </template>
  </div>
  </template>

  <style>
  body {
  background: tomato;
  }
  </style>

  <script>
  export default {
  methods: {
  foo() {
  //
  }
  }
  }
  </script>

Do (Indent the whole buffer):
  gg=G

Expect (All sections indented):
  <template>
    <div>
      <template v-if="loading">
        Loading...
      </template>
    </div>
  </template>

  <style>
  body {
    background: tomato;
  }
  </style>

  <script>
  export default {
    methods: {
      foo() {
        //
      }
    }
  }
  </script>


Given vue (Mixed with custom settings):
  <template>
  <div>
  <template v-if="loading">
  Loading...
  </template>
  </div>
  </template>

  <style>
  body {
  background: tomato;
  }
  </style>

  <script lang="python">
  def fun():
  if foo:
  bar
  </script>

Execute (Customize settings, indent buffer, restore settings):
  let backup_globals = copy(g:)
  let g:vue_indent_languages = [
  \   {'name': 'html', 'pairs': ['<template', '</template>']},
  \   {'name': 'css', 'pairs': ['<style', '</style>']},
  \   {'name': 'python', 'pairs': ['<script lang="python"', '</script>']},
  \ ]
  let g:vue_indent_open_close_tags = 2
  let g:vue_indent_first_line = 0
  normal gg=G
  call extend(g:, backup_globals, 'force')

Expect (All sections indented):
    <template>
  <div>
    <template v-if="loading">
      Loading...
    </template>
  </div>
    </template>

    <style>
  body {
    background: tomato;
  }
    </style>

    <script lang="python">
  def fun():
    if foo:
      bar
    </script>
